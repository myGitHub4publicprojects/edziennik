{% extends "edziennik/base.html" %}

{% block content %}
{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

<p>Nazwa grupy: <b>{{ group.name }}</b><p>

<form action="{% url 'edziennik:add_grades' group.id %}" method="post">
	{% csrf_token %}
	Za co ocena: <input type="text" name="grade_name" required /><br>
	Data testu: <input id="dateOfTest" type="date" name="date_of_test" />(jeśli nie podasz zostanie wybrana dzisiejsza data)<br>

	<table class="table">
	{% for student in students %}
		<tr>
	    	<td><label for="student{{ forloop.counter }}">{{ student.name }}</label></td>
	    	<td><input type="number" min="1" max="6" name="{{ student.name }}" id="student{{ forloop.counter }}" /><br /></td>
	    </tr>
	{% endfor %}
	</table>
	<input id="submitBtn" type="submit" value="Zatwierdzam" />

</form>

{% endblock content %}

{% block javascript %}
<script>
	let submitBtn = document.getElementById('submitBtn');
	submitBtn.addEventListener('click', function(event) {
		let dateOfTest = document.getElementById('dateOfTest');
		let year = dateOfTest.value.split('-')[0];
		year = parseInt(year);
		if (year < (new Date().getFullYear()) - 1 || year > new Date().getFullYear()){
			event.preventDefault();
			dateOfTest.className = 'btn-danger';
			alert('Niewłaściwy rok. Proszę poprawić');
		}
	});


</script>
{% endblock javascript %}