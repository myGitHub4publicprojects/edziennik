{% extends "edziennik/base.html" %}

{% block content %}
{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

<p><small class="text-muted">Nazwa grupy: </small><b>{{ group.name }}</b><p>

<form action="{% url 'edziennik:add_grades' group.id %}" method="post">
	{% csrf_token %}
	<div class="form-group row">
		<label for="whatFor" class="col-sm-2 col-form-label">Za co ocena:</label>
		<div class="col-sm-10">
			
			<input type="text" class="form-control" id="whatFor" name="grade_name" required>
		</div>
	</div>

	<div class="form-group row">
		<label for="staticEmail" class="col-sm-2 col-form-label">Data testu:</label>
		<div class="col-auto">
			<input id="dateOfTest" type="date" name="date_of_test" class="form-control" >
			<small class="form-text text-muted">jeśli nie podasz zostanie wybrana dzisiejsza data</small>
		</div>
	</div>

	<table class="table">
	{% for student in students %}
		<tr>
	    	<td><label for="student{{ forloop.counter }}">{{ student }}</label></td>
	    	<td><input type="number" min="1" max="6" name="{{ student }}" id="student{{ forloop.counter }}" /><br /></td>
	    </tr>
	{% endfor %}
	</table>
	<input id="submitBtn" type="submit" value="Zatwierdzam" />

</form>
{% endblock content %}

{% block javascript %}
<script>
	let submitBtn = document.getElementById('submitBtn');
	submitBtn.addEventListener('click', function(event) {
		let dateOfTest = document.getElementById('dateOfTest');
		let year = dateOfTest.value.split('-')[0];
		year = parseInt(year);
		if (year < (new Date().getFullYear()) - 1 || year > new Date().getFullYear()){
			event.preventDefault();
			dateOfTest.className = 'btn-danger';
			alert('Niewłaściwy rok. Proszę poprawić');
		}
	});


</script>
{% endblock javascript %}